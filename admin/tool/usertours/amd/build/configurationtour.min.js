define("tool_usertours/configurationtour",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;
/**
   * User tours configuration.
   *
   * @module      tool_usertours/configurationtour
   * @copyright   2024 The Open University
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const ANY_VALUE="__ANYVALUE__";_exports.init=()=>{initConfigurationCategoryFilter()};const initConfigurationCategoryFilter=()=>{const categorySelect=document.querySelector("[name='filter_category[]']"),excludeSelect=document.querySelector("[name='filter_exclude_category[]']");categorySelect&&excludeSelect&&(categorySelect.addEventListener("change",(()=>{updateCategorySelectionOptions(categorySelect),updateExcludeCategories(categorySelect,excludeSelect)})),excludeSelect.addEventListener("change",(()=>{updateCategorySelectionOptions(excludeSelect)})),updateExcludeCategories(categorySelect,excludeSelect),updateCategorySelectionOptions(categorySelect),updateCategorySelectionOptions(excludeSelect))},updateExcludeCategories=(categorySelect,excludeSelect)=>{const selectedCategories=new Set(Array.from(categorySelect.selectedOptions).map((option=>option.value))),isAnySelected=((categorySelect,selectedCategories)=>{const anyOption=categorySelect.querySelector('option[value="'.concat(ANY_VALUE,'"]')),isAnySelected=0===selectedCategories.size||1===selectedCategories.size&&selectedCategories.has(ANY_VALUE);return anyOption.selected=isAnySelected,anyOption.disabled=!isAnySelected,isAnySelected&&selectedCategories.add(ANY_VALUE),isAnySelected})(categorySelect,selectedCategories),excludeSelected=new Set(Array.from(excludeSelect.selectedOptions).map((option=>option.value))),excludeOptions=new Map;var select;Array.from(categorySelect.options).filter((option=>option.value!==ANY_VALUE)).forEach((option=>{if(isAnySelected)selectedCategories.has(option.value)||excludeOptions.set(option.value,option.text);else{Array.from(selectedCategories).some((selected=>{const selectedOption=categorySelect.querySelector('option[value="'.concat(selected,'"]'));return option.text.startsWith(selectedOption.text+" / ")}))&&excludeOptions.set(option.value,option.text)}})),excludeSelect.innerHTML=Array.from(excludeOptions).sort(((_ref,_ref2)=>{let[,a]=_ref,[,b]=_ref2;return a.localeCompare(b)})).map((_ref3=>{let[key,value]=_ref3;return'<option value="'.concat(key,'" ').concat(excludeSelected.has(key)?"selected":"",">").concat(value,"</option>")})).join(""),(select=excludeSelect).size=Math.min(select.options.length||1,10)},updateCategorySelectionOptions=categorySelect=>{const selectedCategories=new Set(Array.from(categorySelect.selectedOptions).map((option=>option.value))),categoryOptions=Array.from(categorySelect.options);categoryOptions.forEach((option=>{if(option.value===ANY_VALUE)return;if(selectedCategories.has(option.value))return void(option.disabled=!1);const currentPath=option.text.split(" / ");option.disabled=Array.from(selectedCategories).some((selectedValue=>{if(selectedValue===ANY_VALUE)return!1;const selectedPath=categoryOptions.find((opt=>opt.value===selectedValue)).text.split(" / ");return isParentOrChildPath(currentPath,selectedPath)}))}))},isParentOrChildPath=(path1,path2)=>{const minLength=Math.min(path1.length,path2.length);for(let i=0;i<minLength;i++)if(path1[i]!==path2[i])return!1;return!0}}));

//# sourceMappingURL=configurationtour.min.js.map